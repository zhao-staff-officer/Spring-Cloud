# Zookeeper

[TOC]



## 1.0 分布式理论

### ACID

- 原子性（Atomicity）

  事务必须是一个原子的操作序列单元，事务中包含的各项操作在一次执行过程中，全部执行成功或者全部不执行。任何一项操作都将导致整个事务失败，同时其他已经执行的操作都将被撤销并回滚，只有所有操作全部成功，整个事务才算是成功执行。

- 一致性（Consistency）

  事务的一致性是指事务执行不能破坏数据库数据的完整性和一致性，一个事务在执行之前和执行之后，数据库都必须处于一致性状态。也就是说，事务执行的结果必须是使数据库从一个一致性状态转变到另一个一致性状态，因此当数据库只包含成功事务提交的结果时，就能说数据库处于一致性状态。而如果数据库系统在运行过程中发生故障，有些事务尚未完成就被迫中断，这些未完成的事务对数据库所做的修改有一部分已写入物理数据库，这时数据库就处于一种不正确的状态，或者说不一致的状态。

- 隔离性（Isolation）

  在并发环境中，并发的事务是相互隔离的，一个事务的执行不能被其他事务干扰。也就是说，不同事务并发操作相同的数据时，每个事务都有各自完整的数据空间，即一个事务内部的操作及使用的数据对其他并发事务是隔离的，并发执行各个事务不能互相干扰

  1. 读未提交（ReadUncommitted）

     如果一个事务正在处理某一数据，并对其进行了更新，但同时尚未完成事务，因此还没有进行事务提交；而与此同时，允许另个事务也能够访问改数据。

  2. 读已提交（ReadCommited）

     只允许获取已经提交的数据。

  3. 可重复度（RepetableRead）

     事务在处理过程稿，多次读取同一数据时，其值都和事务开始时刻是一致的。因此该事务级别禁止了不可重复读取与脏读，但是有肯呢个出现幻影数据。幻影数据指同样的事务操作，在前后两个时间段内执行对同一数据项的读取，可能出现不一致的结果。

  4. 串行化（Serializable）

     | 隔离级别 | 脏读 | 不可重复读 | 幻读 |
     | :------: | :--: | :--------: | :--: |
     | 读未提交 |  ✓   |     ✓      |  ✓   |
     | 读已提交 |  ×   |     ✓      |  ✓   |
     | 可重复读 |  ×   |     ×      |  ✓   |
     |  串行化  |  ×   |     ×      |  ×   |
     
     **脏读(Drity Read)：** 
     
     某个事务已更新一份数据，另一个事务在此时读取了同一份数据，由于某些原因，前一个RollBack了操作，则后一个事务所读取的数据就会是不正确的
     
     
     
     **不可重复读(Non-repeatable read):**
     
     在一个事务的两次查询之中数据不一致，这可能是两次查询过程中间插入了一个事务更新的原有的数据。
     
     
     
     **幻读(Phantom Read):**
     
     在一个事务的两次查询中数据笔数不一致，例如有一个事务查询了几列(Row)数据，而另一个事务却在此时插入了新的几列数据，先前的事务在接下来的查询中，就会发现有几列数据是它先前所没有的。
     
     

- 持久性（Durability）

  事务的持久性也被称为永久性，是指一个事务一旦提交，它对数据库中对应数据的状态变更应该是永久性的。换句话说，一旦某个事务成功结束，那么它对数据库所做的更新就必须永久保存下来-即使反思系统崩溃或者机器宕机等故障，只要数据库能够重新启动，那么一定能够将其恢复到事务成功结束时的状态。

### CAP

​		一个分布式系统不可能同时满足一致性（C:Consistency）、可用性（A：Availability）和分区容错性（P：Partition tolerance） 这三个基本需求，最多只能同时满足其中两项。

1. 一致性

   在分布式环境中，一致性是指数据在多个副本之间是否能够保存一致的特效。在一致性的需求下，当一个系统在数据一致的状态下执行更新操作后，应该保证系统的数据任然处于一致的状态。  

2. 可用性

   可用性是指系统提供的服务必须一直处于可用的状态，对于用户的每一个操作总是能够在有限时间内返回结果。

3. 分区容错性

   分区容错性约束了一个分布式系统需要具有如下特性：分布式系统在遇到任何网络分区故障的时候，任然能够保证堆外提供满足一致性和可用性的服务，除非是整个网络环境发送了故障。

   

   

   

### BASE